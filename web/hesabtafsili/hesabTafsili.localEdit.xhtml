<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	
	
	xmlns:custom="http://seraj.com/seraj/facelet"
	xmlns:t="http://myfaces.apache.org/tomahawk" 
	xmlns:p="http://primefaces.org/ui">
	
<ui:composition template="/template/template-edit.xhtml">
	<ui:param name="title" value="HesabTafsili_edit_create" />
	<ui:param name="owner" value="#{hesabTafsili}" />
	<ui:define name="fixsection">
	</ui:define>

	<ui:define name="editsection">
		<t:saveState value="#{owner.hesabClassifications}" />
		<p:panel  styleClass="emptyDiv" bodyClass="emptyDiv" >
			<p:panelGrid layout="grid"  columns="2" width="90%"
				columnClasses="viewLableColResponsive ui-grid-col-3,inputCol ui-grid-col-9"
				styleClass="inputForm  ">

				<h:panelGroup>
					<h:outputText styleClass="required" value="   " />
					<h:outputLabel for="code" value="#{messages['HesabTafsili_code']}" /> :  
				</h:panelGroup>
				<p:inputText id="code" label="code"  converter="javax.faces.Long"
					value="#{hesabTafsili.entity.code}" size="50" />

				<h:panelGroup>
					<h:outputText styleClass="required" value="* " />
					<h:outputLabel for="name" value="#{messages['HesabTafsili_name']}" /> : 
				</h:panelGroup>
				<p:inputText required="true" id="name" label="name"
					value="#{hesabTafsili.entity.name}" size="50" />

				<h:panelGroup>
					<h:outputText styleClass="required" value="* " />
					<h:outputLabel for="level" value="#{messages['HesabTafsili_level']}" /> :  
				</h:panelGroup>
				<p:selectOneMenu id="level" value="#{hesabTafsili.entity.level}" widgetVar="hesabTafsiliLevelWidget"  converter="javax.faces.Integer" onchange="changeLevel(this.value);"
					label="#{messages['HesabTafsili_level']}">
					<p:ajax listener="#{hesabTafsili.handleChangelevel}" update="hesabClassification" />
					<f:selectItem itemLabel="-------" itemValue=""/>
					<f:selectItem itemLabel="#{messages['common_one']}" itemValue="1"/>
					<f:selectItem itemLabel="#{messages['common_two']}" itemValue="2"/>
				</p:selectOneMenu>				


				<h:panelGroup>
					<h:outputLabel for="tafsilType"
						value="#{messages['HesabTafsili_tafsilType']}" /> : 
				</h:panelGroup>
				<h:selectOneMenu value="#{hesabTafsili.entity.tafsilType}"  converter="seraj.converter.Enum"
					label="#{messages['HesabTafsili_type']}" id="tafsilType">
					<f:selectItems value="#{enums.TafsilTypeEnum}" />
				</h:selectOneMenu>

				<h:panelGroup>
					<h:outputText styleClass="required" value="  " />
					<h:outputLabel for="description"
						value="#{messages['HesabTafsili_description']}" /> : 
				</h:panelGroup>
				<p:inputText  id="description" label="description"
					value="#{hesabTafsili.entity.description}" size="50" />

					
				<h:panelGroup>
					<h:outputText styleClass="required"	value="  " />
					<h:outputLabel for="hesabClassification" value="#{messages['HesabClassification_title']}" /> : 
				</h:panelGroup>
				<h:selectOneMenu value="#{hesabTafsili.entity.hesabClassification.id}"  converter="javax.faces.Long"
					label="#{messages['HesabClassification_title']}" id="hesabClassification">
					<f:selectItems value="#{owner.hesabClassifications}" var="classification"
                   itemLabel="#{classification.desc}" itemValue="#{classification.id}"/>
				</h:selectOneMenu>
			

				<h:panelGroup>
					<h:outputText styleClass="required" value="* " />
					<h:outputLabel for="moeens"
						value="#{messages['HesabTafsili_moeens']}" /> : 
				</h:panelGroup>
				<h:panelGroup>
					<custom:autocomplete-multiple id="moeens" width="220px" required="true" label="#{messages['HesabTafsili_moeens']}"
						selectedIds="#{hesabTafsili.moeenIds}" entity="HesabMoeen"
						property="code, name" ajax="false" extraParams="isHierarchical=true"/>
				</h:panelGroup>

				<h:panelGroup rendered="true">
					<h:outputLabel for="childTafsilies"
						value="#{messages['HesabTafsili_childs']}" /> : 
				</h:panelGroup>
				<h:panelGroup rendered="true">
					<custom:autocomplete-multiple id="childTafsilies" width="220px"
						selectedIds="#{hesabTafsili.childTafsiliIds}" entity="HesabTafsili"
						property="code, name" ajax="false" extraParams="isHierarchical=true&amp;&amp;tafsiliLevel=#{hesabTafsili.entity.level+1}"/>
				</h:panelGroup>

				<h:panelGroup rendered="false">
					<h:outputLabel for="childAccountingMarkazes"
						value="#{messages['HesabTafsili_childAccountingMarkazs']}" /> : 
				</h:panelGroup>
				<h:panelGroup rendered="false">
					<custom:autocomplete-multiple id="childAccountingMarkazes" width="220px"
						selectedIds="#{hesabTafsili.childAccountingMarkazIds}" entity="AccountingMarkaz"
						property="code, name" ajax="false" extraParams="isCurrentOrgan=true"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="hidden"
						value="#{messages['HesabTafsili_hidden']}" /> : 
				</h:panelGroup>
				<h:selectBooleanCheckbox id="hidden" label="hidden"
					value="#{hesabTafsili.entity.hidden}" />

			</p:panelGrid>
		</p:panel>
		<script>
		/* <![CDATA[ */
		var hesabTafsilis;
		$$(function() {
			//alert(PF('hesabTafsiliLevelWidget').getSelectedValue());
			//populateTafsilis(PF('hesabTafsiliLevelWidget').getSelectedValue());
		});
		 
		 function changeLevel(level){
		 		$$('#childTafsilies_div').empty();
				$$('#childTafsilies_id').val('');
				populateTafsilis(level);
		 }
		 function populateTafsilis(level){
				debugger;
				//alert('level : '+level);
			 	if(level =='' || level == undefined)
			 		render('tafsilies', {}, 0);
				var intLevel = parseInt(level)+parseInt(1);
				$$.ajax({
					  url: '${request.contextPath}/entities?entity=HesabTafsili&property=desc&all=true&autocomplete=true&isHierarchical=true&tafsiliLevel='+intLevel,
					  cache: false,
					  success: function(result){
					    render('childTafsilies', result, 0);
					  },
					  error: function(jqXHR, textStatus, errorThrown){
							alert(errorThrown);
						}
				});
			 
		 }
			/* ]]> */
		</script>		
		
	</ui:define>
	<ui:define name="buttonsection">
		<h:commandButton styleClass=" gwt-Button"  rendered="#{owner.editable  and owner.isForMyOrgan}"
			action="#{owner.localTafsilSave}" value="#{messages['common_save']}"
			image="/images/savebtn.png" />

		<h:commandButton styleClass=" gwt-Button" rendered="#{owner.backable}"
			action="#{owner.back}" value="#{messages['common_back']}"
			immediate="true" image="/images/listbtn.png" />
	</ui:define>	
</ui:composition>

</html>	